<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/themes/prism.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.2.0/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@6.7.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.2.7"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.2.0/dist/index.umd.min.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, data) => {
        const {
          Markmap
        } = getMarkmap();
        window.mm = Markmap.create('svg#mindmap', getOptions == null ? void 0 : getOptions(), data);
      })(() => window.markmap,null,{"t":"heading","d":1,"p":{"lines":[0,1]},"v":"Object","c":[{"t":"heading","d":2,"p":{"lines":[2,3]},"v":"class TaggedImpl","c":[{"t":"list_item","d":4,"p":{"lines":[3,36]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">14</span> <span class=\"token comment\">// An TaggedImpl is a base class for Object (which is either a Smi or a strong</span>\n<span class=\"token number\">15</span> <span class=\"token comment\">// reference to a HeapObject) and MaybeObject (which is either a Smi, a strong</span>\n<span class=\"token number\">16</span> <span class=\"token comment\">// reference to a HeapObject, a weak reference to a HeapObject, or a cleared</span>\n<span class=\"token number\">17</span> <span class=\"token comment\">// weak reference.</span>\n<span class=\"token number\">18</span> <span class=\"token comment\">// This class provides storage and one canonical implementation of various</span>\n<span class=\"token number\">19</span> <span class=\"token comment\">// predicates that check Smi and heap object tags' values and also take into</span>\n<span class=\"token number\">20</span> <span class=\"token comment\">// account whether the tagged value is expected to be weak reference to a</span>\n<span class=\"token number\">21</span> <span class=\"token comment\">// HeapObject or cleared weak reference.</span>\n<span class=\"token number\">22</span> <span class=\"token keyword\">template</span> <span class=\"token operator\">&lt;</span>HeapObjectReferenceType kRefType<span class=\"token punctuation\">,</span> <span class=\"token keyword\">typename</span> <span class=\"token class-name\">StorageType</span><span class=\"token operator\">></span>\n<span class=\"token number\">23</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TaggedImpl</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">36</span>   <span class=\"token keyword\">constexpr</span> <span class=\"token function\">TaggedImpl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> ptr_<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token number\">37</span>   <span class=\"token keyword\">explicit</span> <span class=\"token keyword\">constexpr</span> <span class=\"token function\">TaggedImpl</span><span class=\"token punctuation\">(</span>StorageType ptr<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">ptr_</span><span class=\"token punctuation\">(</span>ptr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">66</span>   <span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">inline</span> <span class=\"token keyword\">bool</span> <span class=\"token function\">IsObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token function\">IsWeakOrCleared</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">67</span>\n<span class=\"token number\">68</span>   <span class=\"token comment\">// Returns true if this tagged value is a Smi.</span>\n<span class=\"token number\">69</span>   <span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">bool</span> <span class=\"token function\">IsSmi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token function\">HAS_SMI_TAG</span><span class=\"token punctuation\">(</span>ptr_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">73</span>   <span class=\"token comment\">// Returns true if this tagged value is a strong pointer to a HeapObject.</span>\n<span class=\"token number\">74</span>   <span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">inline</span> <span class=\"token keyword\">bool</span> <span class=\"token function\">IsHeapObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token function\">IsStrong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">88</span>   <span class=\"token comment\">// Returns true if this tagged value is a strong pointer to a HeapObject.</span>\n<span class=\"token number\">89</span>   <span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">inline</span> <span class=\"token keyword\">bool</span> <span class=\"token function\">IsStrong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">91</span>     <span class=\"token keyword\">return</span> kCanBeWeak <span class=\"token operator\">?</span> <span class=\"token function\">HAS_STRONG_HEAP_OBJECT_TAG</span><span class=\"token punctuation\">(</span>ptr_<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token operator\">!</span><span class=\"token function\">IsSmi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token number\">92</span>   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">181</span>   StorageType ptr_<span class=\"token punctuation\">;</span>\n<span class=\"token number\">182</span> <span class=\"token punctuation\">}</span>\n</code></pre>\n"}]},{"t":"heading","d":2,"p":{"lines":[36,37]},"v":"class Object","c":[{"t":"list_item","d":4,"p":{"lines":[37,65]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// src/objects/objects.h</span>\n<span class=\"token number\">35</span> <span class=\"token comment\">// Most object types in the V8 JavaScript are described in this file.</span>\n<span class=\"token number\">36</span> <span class=\"token comment\">//</span>\n<span class=\"token number\">37</span> <span class=\"token comment\">// Inheritance hierarchy:</span>\n<span class=\"token number\">38</span> <span class=\"token comment\">// - Object</span>\n<span class=\"token number\">39</span> <span class=\"token comment\">//   - Smi          (immediate small integer)</span>\n<span class=\"token number\">40</span> <span class=\"token comment\">//   - TaggedIndex  (properly sign-extended immediate small integer)</span>\n<span class=\"token number\">41</span> <span class=\"token comment\">//   - HeapObject   (superclass for everything allocated in the heap)</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">190</span> <span class=\"token comment\">// Formats of Object::ptr_:</span>\n<span class=\"token number\">191</span> <span class=\"token comment\">//  Smi:        [31 bit signed int] 0</span>\n<span class=\"token number\">192</span> <span class=\"token comment\">//  HeapObject: [32 bit direct pointer] (4 byte aligned) | 01</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">265</span> <span class=\"token comment\">// Object is the abstract superclass for all classes in the</span>\n<span class=\"token number\">266</span> <span class=\"token comment\">// object hierarchy.</span>\n<span class=\"token number\">267</span> <span class=\"token comment\">// Object does not use any virtual functions to avoid the</span>\n<span class=\"token number\">268</span> <span class=\"token comment\">// allocation of the C++ vtable.</span>\n<span class=\"token number\">269</span> <span class=\"token comment\">// There must only be a single data member in Object: the Address ptr,</span>\n<span class=\"token number\">270</span> <span class=\"token comment\">// containing the tagged heap pointer that this Object instance refers to.</span>\n<span class=\"token number\">271</span> <span class=\"token comment\">// For a design overview, see https://goo.gl/Ph4CGz.</span>\n<span class=\"token number\">272</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Object</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">TaggedImpl</span><span class=\"token operator\">&lt;</span>HeapObjectReferenceType<span class=\"token double-colon punctuation\">::</span><span class=\"token class-name\">STRONG</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Address</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">273</span>  <span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n<span class=\"token number\">274</span>   <span class=\"token keyword\">constexpr</span> <span class=\"token function\">Object</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">TaggedImpl</span><span class=\"token punctuation\">(</span>kNullAddress<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> \n<span class=\"token number\">275</span>   <span class=\"token keyword\">explicit</span> <span class=\"token keyword\">constexpr</span> <span class=\"token function\">Object</span><span class=\"token punctuation\">(</span>Address ptr<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">TaggedImpl</span><span class=\"token punctuation\">(</span>ptr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n</code></pre>\n"}]},{"t":"heading","d":2,"p":{"lines":[65,66]},"v":"class Map","c":[{"t":"list_item","d":4,"p":{"lines":[66,117]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// src/objects/map.h</span>\n<span class=\"token number\">115</span> <span class=\"token comment\">// Map layout:</span>\n<span class=\"token number\">116</span> <span class=\"token comment\">// +---------------+-------------------------------------------------+  ptr_ - 1 (kHeapObjectTag == 1)</span>\n<span class=\"token number\">117</span> <span class=\"token comment\">// |   _ Type _    | _ Description _                                 |</span>\n<span class=\"token number\">118</span> <span class=\"token comment\">// +---------------+-------------------------------------------------+</span>\n<span class=\"token number\">119</span> <span class=\"token comment\">// | TaggedPointer | map - Always a pointer to the MetaMap root      |</span>\n<span class=\"token number\">120</span> <span class=\"token comment\">// +---------------+-------------------------------------------------+  ptr_ + 4 - 1 </span>\n<span class=\"token number\">121</span> <span class=\"token comment\">// | Int           | The first int field                             |</span>\n<span class=\"token number\">122</span> <span class=\"token comment\">//  `---+----------+-------------------------------------------------+</span>\n<span class=\"token number\">123</span> <span class=\"token comment\">//      | Byte     | [instance_size]                                 |</span>\n<span class=\"token number\">124</span> <span class=\"token comment\">//      +----------+-------------------------------------------------+</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">137</span> <span class=\"token comment\">// +----+----------+-------------------------------------------------+</span>\n<span class=\"token number\">138</span> <span class=\"token comment\">// | Int           | The second int field                            |</span>\n<span class=\"token number\">139</span> <span class=\"token comment\">//  `---+----------+-------------------------------------------------+  ptr_ + 8 - 1 (kInstanceTypeOffset == 8)</span>\n<span class=\"token number\">140</span> <span class=\"token comment\">//      | Short    | [instance_type]                                 |</span>\n<span class=\"token number\">141</span> <span class=\"token comment\">//      +----------+-------------------------------------------------+</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">156</span> <span class=\"token comment\">// +----+----------+-------------------------------------------------+  ptr_ + 12 - 1 </span>\n<span class=\"token number\">157</span> <span class=\"token comment\">// | Int           | [bit_field3]                                    |</span>\n<span class=\"token number\">158</span> <span class=\"token comment\">// |               |   - enum_length (bit 0..9)                      |</span>\n<span class=\"token number\">159</span> <span class=\"token comment\">// |               |   - number_of_own_descriptors (bit 10..19)      |</span>\n<span class=\"token number\">160</span> <span class=\"token comment\">// |               |   - is_prototype_map (bit 20)                   |</span>\n<span class=\"token number\">161</span> <span class=\"token comment\">// |               |   - is_dictionary_map (bit 21)                  |</span>\n<span class=\"token number\">162</span> <span class=\"token comment\">// |               |   - owns_descriptors (bit 22)                   |</span>\n<span class=\"token number\">163</span> <span class=\"token comment\">// |               |   - is_in_retained_map_list (bit 23)            |</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">171</span> <span class=\"token comment\">// +*****************************************************************+  ptr_ + 16 - 1 (optional)</span>\n<span class=\"token number\">172</span> <span class=\"token comment\">// | Int           | On systems with 64bit pointer types, there      |</span>\n<span class=\"token number\">173</span> <span class=\"token comment\">// |               | is an unused 32bits after bit_field3            |</span>\n<span class=\"token number\">174</span> <span class=\"token comment\">// +*****************************************************************+  ptr_ + 16 - 1 (kPrototypeOffset == 16)</span>\n<span class=\"token number\">175</span> <span class=\"token comment\">// | TaggedPointer | [prototype]                                     |</span>\n<span class=\"token number\">176</span> <span class=\"token comment\">// +---------------+-------------------------------------------------+</span>\n<span class=\"token number\">177</span> <span class=\"token comment\">// | TaggedPointer | [constructor_or_back_pointer_or_native_context] |</span>\n<span class=\"token number\">178</span> <span class=\"token comment\">// +---------------+-------------------------------------------------+  ptr_ + 24 - 1 (kInstanceDescriptorsOffset == 24)</span>\n<span class=\"token number\">179</span> <span class=\"token comment\">// | TaggedPointer | [instance_descriptors]                          |</span>\n<span class=\"token number\">180</span> <span class=\"token comment\">// +*****************************************************************+</span>\n<span class=\"token number\">181</span> <span class=\"token comment\">// | TaggedPointer | [dependent_code]                                |</span>\n<span class=\"token number\">182</span> <span class=\"token comment\">// +---------------+-------------------------------------------------+</span>\n<span class=\"token number\">183</span> <span class=\"token comment\">// | TaggedPointer | [prototype_validity_cell]                       |</span>\n<span class=\"token number\">184</span> <span class=\"token comment\">// +---------------+-------------------------------------------------+</span>\n<span class=\"token number\">185</span> <span class=\"token comment\">// | TaggedPointer | If Map is a prototype map:                      |</span>\n<span class=\"token number\">186</span> <span class=\"token comment\">// |               |   [prototype_info]                              |</span>\n<span class=\"token number\">187</span> <span class=\"token comment\">// |               | Else:                                           |</span>\n<span class=\"token number\">188</span> <span class=\"token comment\">// |               |   [raw_transitions]                             |</span>\n<span class=\"token number\">189</span> <span class=\"token comment\">// +---------------+-------------------------------------------------+</span>\n<span class=\"token number\">191</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Map</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">TorqueGeneratedMap</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">HeapObject</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">192</span>  <span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n</code></pre>\n"},{"t":"list_item","d":4,"p":{"lines":[117,118]},"v":"Map::instance_type()","c":[{"t":"list_item","d":6,"p":{"lines":[118,177]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// b ../../src/objects/map-inl.h:343</span>\n<span class=\"token comment\">// (gdb) x/1xh this->ptr_ + kInstanceTypeOffset - kHeapObjectTag</span>\n<span class=\"token comment\">// +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n\n<span class=\"token comment\">// src/objects/map-inl.h</span>\n<span class=\"token number\">339</span> InstanceType <span class=\"token class-name\">Map</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">instance_type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">340</span>   <span class=\"token comment\">// TODO(solanes, v8:7790, v8:11353, v8:11945): Make this and the setter</span>\n<span class=\"token number\">341</span>   <span class=\"token comment\">// non-atomic when TSAN sees the map's store synchronization.</span>\n<span class=\"token number\">342</span>   <span class=\"token keyword\">return</span> <span class=\"token generic-function\"><span class=\"token function\">static_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>InstanceType<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>\n<span class=\"token number\">343</span>       <span class=\"token function\">RELAXED_READ_UINT16_FIELD</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> kInstanceTypeOffset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token number\">344</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// src/objects/object-macros.h</span>\n<span class=\"token number\">550</span> #define <span class=\"token function\">RELAXED_READ_UINT16_FIELD</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">)</span> \\\n<span class=\"token number\">551</span>   <span class=\"token generic-function\"><span class=\"token function\">static_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token keyword\">uint16_t</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>base<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">Relaxed_Load</span><span class=\"token punctuation\">(</span>  \\\n<span class=\"token number\">552</span>       <span class=\"token generic-function\"><span class=\"token function\">reinterpret_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token keyword\">const</span> base<span class=\"token double-colon punctuation\">::</span>Atomic16<span class=\"token operator\">*</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token function\">FIELD_ADDR</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token number\">422</span> #define <span class=\"token function\">FIELD_ADDR</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ptr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> offset <span class=\"token operator\">-</span> kHeapObjectTag<span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p kHeapObjectTag\n$<span class=\"token number\">160</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p Map<span class=\"token double-colon punctuation\">::</span>kInstanceTypeOffset\n$<span class=\"token number\">161</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span>\n<span class=\"token comment\">// +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n<span class=\"token comment\">// Debug Demo1:</span>\n<span class=\"token comment\">// #0  0x000055555565467c in Map::instance_type (this=0x7fffffffade8) </span>\n<span class=\"token comment\">//     at ../../src/objects/map-inl.h:342</span>\n<span class=\"token comment\">// 339  InstanceType Map::instance_type() const {</span>\n<span class=\"token comment\">// 342    return static_cast&lt;InstanceType>(</span>\n<span class=\"token comment\">// 343        RELAXED_READ_UINT16_FIELD(*this, kInstanceTypeOffset));</span>\n\n<span class=\"token comment\">// 0x0000555555654678 &lt;+40>:    add    rsp,0x10</span>\n<span class=\"token comment\">// => 0x000055555565467c &lt;+44>: pop    rbp</span>\n<span class=\"token comment\">// 0x000055555565467d &lt;+45>:    ret</span>\n<span class=\"token comment\">// End of assembler dump.</span>\n\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x <span class=\"token keyword\">this</span><span class=\"token operator\">-></span>ptr_ <span class=\"token operator\">+</span> kInstanceTypeOffset <span class=\"token operator\">-</span> kHeapObjectTag\n$<span class=\"token number\">143</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x53308002120</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> x<span class=\"token operator\">/</span><span class=\"token number\">1</span>xh <span class=\"token number\">0x53308002120</span>\n<span class=\"token number\">0x53308002120</span><span class=\"token operator\">:</span>  <span class=\"token number\">0x00ab</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> i reg eax\neax            <span class=\"token number\">0xab</span>     \n<span class=\"token comment\">// +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n<span class=\"token comment\">// Debug Demo2: </span>\n<span class=\"token comment\">// b ../../src/compiler/heap-refs.cc:1040</span>\n<span class=\"token comment\">// Thread 1 \"d8\" hit Breakpoint 35, MapData::MapData </span>\n<span class=\"token comment\">//    at ../../src/compiler/heap-refs.cc:1040</span>\n<span class=\"token comment\">// 1040   instance_type_ = object->instance_type();</span>\n<span class=\"token comment\">// (gdb) n</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p instance_type_\n$<span class=\"token number\">170</span> <span class=\"token operator\">=</span> <span class=\"token function\">JS_GLOBAL_PROXY_TYPE</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> x<span class=\"token operator\">/</span><span class=\"token number\">1</span>xh object<span class=\"token operator\">-></span>ptr_ <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n<span class=\"token number\">0x1040082c6f90</span><span class=\"token operator\">:</span> <span class=\"token number\">0x00bd</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p instance_type_ <span class=\"token operator\">==</span> <span class=\"token number\">0x00bd</span>\n$<span class=\"token number\">171</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n<span class=\"token comment\">// +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n</code></pre>\n"},{"t":"list_item","d":6,"p":{"lines":[177,178]},"v":"InstanceType","c":[{"t":"list_item","d":8,"p":{"lines":[178,212]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// src/objects/instance-type.h</span>\n<span class=\"token number\">75</span> <span class=\"token keyword\">enum</span> <span class=\"token class-name\">InstanceType</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">uint16_t</span> <span class=\"token punctuation\">{</span>\n    MAP_TYPE <span class=\"token operator\">=</span> <span class=\"token number\">0xab</span><span class=\"token punctuation\">,</span>\n    PROPERTY_CELL_TYPE <span class=\"token operator\">=</span> <span class=\"token number\">0xb0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    JS_OBJECT_TYPE <span class=\"token operator\">=</span> <span class=\"token number\">0x421</span><span class=\"token punctuation\">,</span>\n    FIRST_JS_OBJECT_TYPE <span class=\"token operator\">=</span> <span class=\"token number\">0xbc</span><span class=\"token punctuation\">,</span>\n    FIRST_JS_FUNCTION_TYPE <span class=\"token operator\">=</span> <span class=\"token number\">0x80c</span><span class=\"token punctuation\">,</span>\n    JS_GLOBAL_PROXY_TYPE <span class=\"token operator\">=</span> <span class=\"token number\">0xbd</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 可以在这里下断点</span>\n<span class=\"token number\">985</span> InstanceType <span class=\"token class-name\">HeapObjectData</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">GetMapInstanceType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">986</span>   ObjectData<span class=\"token operator\">*</span> map_data <span class=\"token operator\">=</span> <span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token number\">987</span>   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>map_data<span class=\"token operator\">-></span><span class=\"token function\">should_access_heap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">988</span>     <span class=\"token keyword\">return</span> <span class=\"token class-name\">Handle</span><span class=\"token operator\">&lt;</span>Map<span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">cast</span><span class=\"token punctuation\">(</span>map_data<span class=\"token operator\">-></span><span class=\"token function\">object</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">instance_type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token number\">989</span>   <span class=\"token punctuation\">}</span>\n    \n<span class=\"token number\">990</span>   <span class=\"token keyword\">return</span> map_data<span class=\"token operator\">-></span><span class=\"token function\">AsMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">instance_type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token number\">991</span> <span class=\"token punctuation\">}</span>\n\nb <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>compiler<span class=\"token operator\">/</span>heap<span class=\"token operator\">-</span>refs<span class=\"token punctuation\">.</span>cc<span class=\"token operator\">:</span><span class=\"token number\">988</span>\n<span class=\"token function\">display</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>Map <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> map_data<span class=\"token operator\">-></span><span class=\"token function\">object</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">location</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">instance_type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndisplay <span class=\"token operator\">/</span><span class=\"token function\">x</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>Map <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> map_data<span class=\"token operator\">-></span><span class=\"token function\">object</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">location</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">instance_type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nb <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>compiler<span class=\"token operator\">/</span>heap<span class=\"token operator\">-</span>refs<span class=\"token punctuation\">.</span>cc<span class=\"token operator\">:</span><span class=\"token number\">990</span>\n<span class=\"token function\">display</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>MapData <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> map_data<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>instance_type_\ndisplay <span class=\"token operator\">/</span><span class=\"token function\">x</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>MapData <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> map_data<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>instance_type_\n\n</code></pre>\n"}]}]},{"t":"list_item","d":4,"p":{"lines":[212,213]},"v":"Map::instance_descriptors()","c":[{"t":"list_item","d":6,"p":{"lines":[213,217]},"v":"","c":[{"t":"list_item","d":8,"p":{"lines":[214,215],"index":1},"v":"1. 通过 map 获取 cage_base"},{"t":"list_item","d":8,"p":{"lines":[215,216],"index":2},"v":"2. 通过 map 获取 偏移"},{"t":"list_item","d":8,"p":{"lines":[216,217],"index":3},"v":"3. cage_base + 偏移 地址作为 ptr_ 创建 DescriptorArray 对象"}]},{"t":"list_item","d":6,"p":{"lines":[217,395]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// src/objects/map-inl.h:38</span>\n<span class=\"token comment\">// #1  0x00007ffff61897cd in Map::instance_descriptors </span>\n<span class=\"token comment\">//     (this=0x7fffffffb198, cage_base=...) at ../../src/objects/map-inl.h:38</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nDescriptorArray <span class=\"token class-name\">Map</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">instance_descriptors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    PtrComprCageBase cage_base <span class=\"token operator\">=</span> <span class=\"token function\">GetPtrComprCageBase</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token class-name\">Map</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">instance_descriptors</span><span class=\"token punctuation\">(</span>cage_base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nDescriptorArray <span class=\"token class-name\">Map</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">instance_descriptors</span><span class=\"token punctuation\">(</span>PtrComprCageBase cage_base<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    DescriptorArray value <span class=\"token operator\">=</span>\n        <span class=\"token class-name\">TaggedField</span><span class=\"token operator\">&lt;</span>DescriptorArray<span class=\"token punctuation\">,</span> kInstanceDescriptorsOffset<span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span>cage_base<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">;</span>   \n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p kInstanceDescriptorsOffset\n$<span class=\"token number\">136</span> <span class=\"token operator\">=</span> <span class=\"token number\">24</span>\n<span class=\"token comment\">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n<span class=\"token comment\">// 0x00007ffff61897c8 &lt;+56>:    call   0x7ffff7cf9cb0 &lt;...load...></span>\n<span class=\"token comment\">// => 0x00007ffff61897cd &lt;+61>: mov    QWORD PTR [rbp-0x8],rax</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x value<span class=\"token punctuation\">.</span>ptr_\n$<span class=\"token number\">23</span> <span class=\"token operator\">=</span> <span class=\"token number\">0xaaaaaaaaaaaaaaaa</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> <span class=\"token function\">si</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x value<span class=\"token punctuation\">.</span>ptr_\n$<span class=\"token number\">24</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x26dd08109a19</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x cage_base<span class=\"token punctuation\">.</span>address_ <span class=\"token operator\">+</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token operator\">-></span>ptr_ <span class=\"token operator\">-</span> kHeapObjectTag <span class=\"token operator\">+</span> <span class=\"token number\">0x18</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n$<span class=\"token number\">26</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x26dd08109a19</span>\n</code></pre>\n","c":[{"t":"list_item","d":8,"p":{"lines":[246,259]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// GetPtrComprCageBase</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x <span class=\"token function\">GetPtrComprCageBase</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n$<span class=\"token number\">132</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    address_ <span class=\"token operator\">=</span> <span class=\"token number\">0x248a00000000</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span><span class=\"token function\">x</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>Isolate <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token operator\">-></span>ptr_  <span class=\"token operator\">&amp;</span> <span class=\"token operator\">~</span>kPageAlignmentMask<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0xa2f8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>isolate_data_<span class=\"token punctuation\">.</span>cage_base_\n$<span class=\"token number\">134</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x248a00000000</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> ptype <span class=\"token keyword\">this</span>\ntype <span class=\"token operator\">=</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Map</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n</code></pre>\n"},{"t":"list_item","d":8,"p":{"lines":[259,395]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// TaggedField&lt;DescriptorArray, kInstanceDescriptorsOffset>::load</span>\n<span class=\"token comment\">// (gdb) bt</span>\n<span class=\"token comment\">//#0  0x000055555560d904 in TaggedImpl&lt;(HeapObjectReferenceType)1, unsigned long>::ptr (this=0x555555655675 &lt;Map::Map()+21>) at ../../src/objects/tagged-impl.h:62</span>\n<span class=\"token comment\">// #1  0x0000555555655565 in HeapObject::address (this=0x7fffffffaf98) at ../../src/objects/heap-object.h:111</span>\n<span class=\"token comment\">// #2  0x00007ffff61a6518 in TaggedField&lt;DescriptorArray, 24>::address (host=..., offset=0) at ../../src/objects/tagged-field-inl.h:18</span>\n<span class=\"token comment\">// #3  0x00007ffff61a6493 in TaggedField&lt;DescriptorArray, 24>::location (host=..., offset=0) at ../../src/objects/tagged-field-inl.h:24</span>\n<span class=\"token comment\">// #4  0x00007ffff61a63be in TaggedField&lt;DescriptorArray, 24>::load (cage_base=..., host=..., offset=0) at ../../src/objects/tagged-field-inl.h:67</span>\n<span class=\"token comment\">// #5  0x00007ffff61897cd in Map::instance_descriptors (this=0x7fffffffb198, cage_base=...) at ../../src/objects/map-inl.h:38</span>\n\n<span class=\"token class-name\">TaggedField</span><span class=\"token operator\">&lt;</span>DescriptorArray<span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">load</span> \n    <span class=\"token punctuation\">(</span>cage_base<span class=\"token operator\">=</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> host<span class=\"token operator\">=</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> \n        at <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>objects<span class=\"token operator\">/</span>tagged<span class=\"token operator\">-</span>field<span class=\"token operator\">-</span>inl<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">69</span>\n<span class=\"token number\">64</span>  <span class=\"token keyword\">template</span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">typename</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> kFieldOffset<span class=\"token operator\">></span>\n<span class=\"token number\">65</span>  T <span class=\"token class-name\">TaggedField</span><span class=\"token operator\">&lt;</span>T<span class=\"token punctuation\">,</span> kFieldOffset<span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span>PtrComprCageBase cage_base<span class=\"token punctuation\">,</span>\n<span class=\"token number\">66</span>                                       HeapObject host<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> offset<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">67</span>    Tagged_t value <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token function\">location</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">69</span>    <span class=\"token keyword\">return</span> <span class=\"token function\">T</span><span class=\"token punctuation\">(</span><span class=\"token function\">tagged_to_full</span><span class=\"token punctuation\">(</span>cage_base<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token number\">70</span>  <span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p offset\n$<span class=\"token number\">1</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token comment\">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n<span class=\"token comment\">// location</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p <span class=\"token function\">location</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">)</span>\n$<span class=\"token number\">2</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Tagged_t <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token number\">0x26dd082c7b08</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x host<span class=\"token punctuation\">.</span>ptr_ <span class=\"token operator\">-</span> kHeapObjectTag <span class=\"token operator\">+</span> kFieldOffset <span class=\"token operator\">+</span> offset\n$<span class=\"token number\">3</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x26dd082c7b08</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> x<span class=\"token operator\">/</span><span class=\"token number\">1</span>xw <span class=\"token number\">0x26dd082c7b08</span>\n<span class=\"token number\">0x26dd082c7b08</span><span class=\"token operator\">:</span> <span class=\"token number\">0x08109a19</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x value\n$<span class=\"token number\">7</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x8109a19</span>\n<span class=\"token comment\">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n<span class=\"token comment\">// tagged_to_full</span>\n<span class=\"token comment\">// 0x00007ffff61a644e &lt;+190>:   call   0x7ffff7cfcc80 &lt;..tagged_to_full..></span>\n<span class=\"token comment\">// => 0x00007ffff61a6453 &lt;+195>:    mov    rsi,rax</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> i reg rax\nrax            <span class=\"token number\">0x26dd08109a19</span>     \n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x cage_base<span class=\"token punctuation\">.</span>address_ <span class=\"token operator\">+</span> value\n$<span class=\"token number\">19</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x26dd08109a19</span>\n<span class=\"token comment\">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n<span class=\"token comment\">// T -> DescriptorArray</span>\n<span class=\"token comment\">// 创建一个 DescriptorArray , ptr_属性设置为 0x26dd08109a19</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">37</span>    <span class=\"token keyword\">explicit</span> <span class=\"token keyword\">constexpr</span> <span class=\"token function\">TaggedImpl</span><span class=\"token punctuation\">(</span>StorageType ptr<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">ptr_</span><span class=\"token punctuation\">(</span>ptr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n</code></pre>\n","c":[{"t":"list_item","d":10,"p":{"lines":[307,340]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// location</span>\n<span class=\"token class-name\">TaggedField</span><span class=\"token operator\">&lt;</span>DescriptorArray<span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">location</span> <span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> \n        at <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>objects<span class=\"token operator\">/</span>tagged<span class=\"token operator\">-</span>field<span class=\"token operator\">-</span>inl<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">24</span>\n<span class=\"token number\">22</span>  <span class=\"token keyword\">template</span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">typename</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> kFieldOffset<span class=\"token operator\">></span>\n<span class=\"token number\">23</span>  Tagged_t<span class=\"token operator\">*</span> <span class=\"token class-name\">TaggedField</span><span class=\"token operator\">&lt;</span>T<span class=\"token punctuation\">,</span> kFieldOffset<span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">location</span><span class=\"token punctuation\">(</span>HeapObject host<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> offset<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">24</span>    <span class=\"token keyword\">return</span> <span class=\"token generic-function\"><span class=\"token function\">reinterpret_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>Tagged_t<span class=\"token operator\">*</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token function\">address</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token number\">25</span>  <span class=\"token punctuation\">}</span>\np<span class=\"token operator\">/</span>x <span class=\"token function\">address</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">)</span>\np<span class=\"token operator\">/</span>x host<span class=\"token punctuation\">.</span>ptr_ <span class=\"token operator\">-</span> kHeapObjectTag <span class=\"token operator\">+</span> kFieldOffset <span class=\"token operator\">+</span> offset \n</code></pre>\n","c":[{"t":"list_item","d":12,"p":{"lines":[319,340]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// address</span>\n<span class=\"token class-name\">TaggedField</span><span class=\"token operator\">&lt;</span>DescriptorArray<span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">address</span> <span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> \n    at <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>objects<span class=\"token operator\">/</span>tagged<span class=\"token operator\">-</span>field<span class=\"token operator\">-</span>inl<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">18</span>\n<span class=\"token number\">16</span>  <span class=\"token keyword\">template</span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">typename</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> kFieldOffset<span class=\"token operator\">></span>\n<span class=\"token number\">17</span>  Address <span class=\"token class-name\">TaggedField</span><span class=\"token operator\">&lt;</span>T<span class=\"token punctuation\">,</span> kFieldOffset<span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">address</span><span class=\"token punctuation\">(</span>HeapObject host<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> offset<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">18</span>    <span class=\"token keyword\">return</span> host<span class=\"token punctuation\">.</span><span class=\"token function\">address</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> kFieldOffset <span class=\"token operator\">+</span> offset<span class=\"token punctuation\">;</span>\n<span class=\"token number\">19</span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x kFieldOffset\n$<span class=\"token number\">137</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x18</span>\n</code></pre>\n","c":[{"t":"list_item","d":14,"p":{"lines":[331,340]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// HeapObject.address()</span>\n<span class=\"token class-name\">HeapObject</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">address</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token operator\">=</span><span class=\"token number\">0x248a082c7af1</span><span class=\"token punctuation\">)</span> at <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>objects<span class=\"token operator\">/</span>heap<span class=\"token operator\">-</span>object<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">111</span>\n<span class=\"token number\">111</span>   <span class=\"token keyword\">inline</span> Address <span class=\"token function\">address</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token function\">ptr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> kHeapObjectTag<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x kHeapObjectTag\n$<span class=\"token number\">138</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x1</span>\n</code></pre>\n"}]}]},{"t":"list_item","d":10,"p":{"lines":[340,395]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// tagged_to_full</span>\n#<span class=\"token number\">0</span>  TaggedField<span class=\"token operator\">&lt;</span>DescriptorArray<span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span>\n    <span class=\"token generic-function\"><span class=\"token function\">tagged_to_full</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>PtrComprCageBase<span class=\"token operator\">></span></span></span> \n        <span class=\"token punctuation\">(</span>on_heap_addr<span class=\"token operator\">=</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> tagged_value<span class=\"token operator\">=</span><span class=\"token number\">0x8109a19</span><span class=\"token punctuation\">)</span> \n            at <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>objects<span class=\"token operator\">/</span>tagged<span class=\"token operator\">-</span>field<span class=\"token operator\">-</span>inl<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">36</span>\n<span class=\"token number\">36</span>      <span class=\"token keyword\">return</span> <span class=\"token function\">DecompressTaggedPointer</span><span class=\"token punctuation\">(</span>on_heap_addr<span class=\"token punctuation\">,</span> tagged_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> i reg rax\nrax            <span class=\"token number\">0x26dd08109a19</span>      <span class=\"token number\">42730764933657</span>        \n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x on_heap_addr<span class=\"token punctuation\">.</span>address_ <span class=\"token operator\">+</span> tagged_value\n$<span class=\"token number\">18</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x26dd08109a19</span>   \n</code></pre>\n","c":[{"t":"list_item","d":12,"p":{"lines":[354,395]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// DecompressTaggedPointer</span>\n<span class=\"token generic-function\"><span class=\"token function\">DecompressTaggedPointer</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>PtrComprCageBase<span class=\"token operator\">></span></span></span> \n    <span class=\"token punctuation\">(</span>on_heap_addr<span class=\"token operator\">=</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> raw_value<span class=\"token operator\">=</span><span class=\"token number\">0x8109a19</span><span class=\"token punctuation\">)</span> \n        at <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>common<span class=\"token operator\">/</span>ptr<span class=\"token operator\">-</span>compr<span class=\"token operator\">-</span>inl<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">60</span>\n<span class=\"token number\">60</span>    <span class=\"token keyword\">return</span> <span class=\"token function\">GetPtrComprCageBaseAddress</span><span class=\"token punctuation\">(</span>on_heap_addr<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n<span class=\"token number\">61</span>           <span class=\"token generic-function\"><span class=\"token function\">static_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>Address<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>raw_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x <span class=\"token function\">GetPtrComprCageBaseAddress</span><span class=\"token punctuation\">(</span>on_heap_addr<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> raw_value\n$<span class=\"token number\">16</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x26dd08109a19</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x on_heap_addr<span class=\"token punctuation\">.</span>address_ <span class=\"token operator\">+</span> raw_value\n$<span class=\"token number\">17</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x26dd08109a19</span>\n</code></pre>\n","c":[{"t":"list_item","d":14,"p":{"lines":[367,395]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// GetPtrComprCageBaseAddress</span>\n<span class=\"token function\">GetPtrComprCageBaseAddress</span> <span class=\"token punctuation\">(</span>cage_base<span class=\"token operator\">=</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> \n    at <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>common<span class=\"token operator\">/</span>ptr<span class=\"token operator\">-</span>compr<span class=\"token operator\">-</span>inl<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">41</span>\n<span class=\"token number\">41</span>    <span class=\"token keyword\">return</span> cage_base<span class=\"token punctuation\">.</span><span class=\"token function\">address</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x cage_base<span class=\"token punctuation\">.</span>address_\n$<span class=\"token number\">12</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x26dd00000000</span>\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x cage_base<span class=\"token punctuation\">.</span><span class=\"token function\">address</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n$<span class=\"token number\">13</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x26dd00000000</span>\n</code></pre>\n","c":[{"t":"list_item","d":16,"p":{"lines":[379,395]},"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// address</span>\n<span class=\"token class-name\">PtrComprCageBase</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">address</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> \n    at <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>common<span class=\"token operator\">/</span>ptr<span class=\"token operator\">-</span>compr<span class=\"token operator\">-</span>inl<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span>\n\n<span class=\"token number\">23</span>  Address <span class=\"token class-name\">PtrComprCageBase</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">address</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n<span class=\"token number\">24</span>    Address ret <span class=\"token operator\">=</span> address_<span class=\"token punctuation\">;</span>\n<span class=\"token number\">25</span>    ret <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">reinterpret_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>Address<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token function\">V8_ASSUME_ALIGNED</span><span class=\"token punctuation\">(</span>\n<span class=\"token number\">26</span>        <span class=\"token generic-function\"><span class=\"token function\">reinterpret_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> kPtrComprCageBaseAlignment<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token number\">27</span>    <span class=\"token keyword\">return</span> ret<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">(</span>gdb<span class=\"token punctuation\">)</span> p<span class=\"token operator\">/</span>x kPtrComprCageBaseAlignment\n$<span class=\"token number\">11</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x100000000</span>\n</code></pre>\n"}]}]}]}]}]}]}]},{"t":"heading","d":2,"p":{"lines":[395,396]},"v":"JSObject","c":[{"t":"fence","d":3,"v":"<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// src/objects/js-objects.h</span>\n <span class=\"token number\">301</span> <span class=\"token comment\">// The JSObject describes real heap allocated JavaScript objects with</span>\n <span class=\"token number\">302</span> <span class=\"token comment\">// properties.</span>\n <span class=\"token number\">303</span> <span class=\"token comment\">// Note that the map of JSObject changes during execution to enable inline</span>\n <span class=\"token number\">304</span> <span class=\"token comment\">// caching.</span>\n <span class=\"token number\">305</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JSObject</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">TorqueGeneratedJSObject</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">JSObject</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">JSReceiver</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n <span class=\"token number\">306</span>  <span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n</code></pre>\n"}]}]})</script>
</body>
</html>
